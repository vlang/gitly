<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<title>Gitly</title>
	<meta name="description" content="Open-source development platform written in V">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel='icon' type='image/svg+xml' href='/assets/favicon.svg' sizes='any'>
	<script>
		var repoName = '@app.repo.name';
		var branch = '@app.repo.primary_branch';
		var path = '@app.current_path';
		//var isTopFiles = {{.IsTopFiles}}

		var fetchurl = '/@app.repo.name/tree-data?branch=@app.repo.primary_branch&path=@app.current_path';

		var sshUrl = 'ssh://git&#64;gitly.org/@app.repo.user_name/@app.repo.name';
		var httpsUrl = 'https://@app.repo.user_name&#64;gitly.org/@app.repo.name';
	</script>

	@css '//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700'
	@css '/css/gitly.css'
</head>
<body>

#header {
	<a id='mainlogo' href='/'>Gitly</a>
	.content {
		&nbsp;&nbsp;
		@if app.show_menu
			@if app.repo.user_name != ''
				<a class="repo-author" href='/@app.repo.user_name'>@app.repo.user_name</a>
				<p class="slash">/</p>
			@end
			<a class="repo-name" href='/@app.repo.user_name/@app.repo.name'>@app.repo.name</a>
			@if app.repo.is_public
				<span class="repo-visibility">Public</span>
			@else
				<span class="repo-visibility">Private</span>
			@end
		@end
	}
	@if app.logged_in
	<div class="new">
		<a href="/new">New repository</a>
	</div>
	@end
	<div class="user" tabindex="0">
		@if app.logged_in
			.avatar {
				@if app.user.b_avatar
					<img src="@app.user.avatar">
				@else
					<span>@app.user.avatar</span>
				@end
			}
			.header-dropdown {
				.username {
					<span>Signed in as</span>
					<a href='/@app.user.username'>@app.user.username</a>
				}
				.links {
					<a href='/@app.user.username' class="link">Profile</a>
					<a href='/@app.user.username/repos' class="link">Repositories</a>
					<a href='/@app.user.username/issues' class="link">Issues</a>
					<!-- <a href='/@app.user.username/prs' class="link">Pull requests</a> -->
				}
				.links {
					<a href="/@app.user.username/settings" class="link">Settings</a>
				@if app.user.is_admin
					<a href='/admin' class="link">Admin Panel</a>
				@end
				}
				.links {
					<a href='/logout' class="link">Sign out</a>
				}
				<div class="dropdown-hoverzone"></div>
			}
		@else
			<a href='/login' class='login-button'>Log in</a>
			<a href='/register' class="login-button" style="margin-left: 5px">Register</a>
		@end
	</div>
}

<div class='content'>
<!-- don't show the path on the index page -->
@if app.current_path != ''
	.tree-path {
		@for i, p in app.path_split
			<a href="/@app.repo.user_name/@{app.make_path(i)}">@p</a>
			@if i < app.path_split.len - 1
				/
			@end
		@end
	}
@end

@if app.show_menu
	<div class='repo-stats'>
		<a class='menu' href='/@app.repo.user_name/@app.repo.name/issues'>
			<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="exclamation-circle" class="svg-inline--fa fa-exclamation-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"></path></svg>
			@app.repo.format_open_issues_count()
		</a>
		<a class='menu' href='/@app.repo.user_name/@app.repo.name/contributors'>
			<svg aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z"></path></svg>
			@app.repo.format_contributors_count()
		</a>
		<a class='menu' href='/@app.repo.user_name/@app.repo.name/branches'>
			<svg aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"></path></svg>
			@app.repo.format_branches_count()
		</a>
		<a class='menu' href='/@app.repo.user_name/@app.repo.name/releases'>
			<svg aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"></path></svg>
			@app.repo.format_releases_count()
		</a>
		@if app.repo.user_id == app.user.id
			<a class='menu' href="/@app.repo.user_name/@app.repo.name/settings">
				Settings
			</a>
		@end
	</div>
@end

